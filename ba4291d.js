(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{1203:function(t,e,n){t.exports={}},2628:function(t,e,n){"use strict";n(1203)},2789:function(t,e,n){"use strict";n.r(e);n(41);var o=n(672),r={name:"VerifyMail",head:function(){return{titleTemplate:"验证邮箱 - %s"}},data:function(){return{text:"验证中，请稍后",stats:"info"}},computed:{query:function(){return JSON.parse(atob(this.$route.query.p))}},mounted:function(){var t=this.query,e=t.id,n=t.mail,r=t.sign,c=t.aff,f=void 0===c?"undefined":c;e&&n&&r&&f&&Object(o.isMongoId)(e)&&Object(o.isEmail)(n)&&Object(o.isJWT)(r)&&("undefined"===f||Object(o.isMongoId)(f))?this.verify():(this.$notify.error({title:"验证失败",message:"无效的参数"}),this.$router.replace("/"))},methods:{verify:function(){var t=this;this.$store.commit("loadingComponent",!0);var e=this.query,n=e.id,o=e.mail,r=e.sign,c=e.aff;this.$axios.post("/user/verify_mail/verify",{id:n,mail:o,sign:r,aff:"undefined"===c?void 0:c}).then((function(){t.$notify.success({title:"邮件发送成功",message:"欢迎使用 MikuTools"}),t.text="验证成功，欢迎使用 MikuTools",t.stats="success",t.$store.commit("loadingComponent",!1),t.$store.commit("SET_STORE",{key:"aff",value:"undefined"})})).catch((function(e){t.$notify.error({title:"验证失败",message:e}),t.stats="danger",t.text="验证失败："+e,t.$store.commit("loadingComponent",!1)}))},reVerify:function(){var t=this;this.text="邮件发送中，请耐心等待",this.stats="info",this.$store.commit("loadingComponent",!0);var e=this.query.mail;this.$axios.post("/user/verify_mail",{mail:e}).then((function(){t.$notify.success({title:"邮件发送成功",message:"请查看邮箱，如果未收到可查看垃圾箱"}),t.text="邮件发送成功，请查看邮箱，如果未收到可查看垃圾箱",t.stats="success",t.$store.commit("loadingComponent",!1)})).catch((function(e){t.$notify.error({title:"邮件发送失败",message:e}),t.stats="danger",t.text="邮件发送失败：".concat(e),t.$store.commit("loadingComponent",!1)}))}}},c=(n(2628),n(2)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"verify_mail"},[n("nya-container",{attrs:{title:"验证邮箱"}},[n("div",{staticClass:"verify-box"},[n("h1",{staticClass:"title",class:"is-"+t.stats},[t._v("\n                "+t._s(t.text)+"\n            ")]),"danger"===t.stats?n("button",{staticClass:"nya-btn",attrs:{type:"button"},on:{click:t.reVerify}},[t._v("\n                重新获取邮件\n            ")]):t._e()])])],1)}),[],!1,null,null,null);e.default=component.exports}}]);