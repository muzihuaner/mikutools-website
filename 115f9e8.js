(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{1132:function(t,e,n){t.exports={}},2477:function(t,e,n){"use strict";n(1132)},2747:function(t,e,n){"use strict";n.r(e);var o=n(643),l=n(737),r={name:"SearchPic",data:function(){return{n:"",file:null,data:[],preview:null,loading:!1,loadingText:"上传中···",uploadData:null,apiType:"saucenao"}},methods:{handleChange:function(t){var e=this,n=t.target.files;if(!n.length)return!1;var l=n[0];l.size/1024/1024>5?(this.n="",this.$notify.error({title:"识别失败",message:"请选择大小在5M以内的图片"})):(this.data=[],this.preview=null,Object(o.a)(l).then((function(t){e.preview=t})),this.file=l)},start:function(){var t=this;return!!this.file&&(!this.loading&&(this.data=[],this.loading=!0,void l.a.upload(this,this.file,{format:"webp",useCdn:!1}).then((function(e){t.uploadData=e,t.searchPic()})).catch((function(e){t.$notify.error({title:"上传图片失败",message:e}),t.loading=!1}))))},searchPic:function(){var t=this;this.loadingText="上传中···",(new FormData).append("file",this.file),this.$axios.post("/search_pic",{url:this.uploadData,apiType:this.apiType}).then((function(e){t.data=e.data.data,t.loading=!1})).catch((function(e){t.$notify.error({title:"上传图片失败",message:e}),t.loading=!1}))}}},c=(n(2477),n(2)),d=function(t){t.exports.head={meta:[{hid:"keywords",keywords:"以图搜图,pixiv图片搜索,SauceNAO,MikuTools,Ice-Hazymoon,在线工具"},{hid:"description",description:"动漫图片找出处"}],title:"以图搜图 - MikuTools"},t.options.toolsMeta={name:"以图搜图",path:"/search_pic",head:{meta:[{hid:"keywords",keywords:"以图搜图,pixiv图片搜索,SauceNAO,MikuTools,Ice-Hazymoon,在线工具"},{hid:"description",description:"动漫图片找出处"}],title:"以图搜图 - MikuTools"},hot:"hot",show:!0,key:"image"}},component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search_pic"},[n("nya-container",{attrs:{title:"以图搜图"}},[n("div",{staticClass:"nya-subtitle mt-0"},[t._v("\n            请选择要识别 ACG 图片\n        ")]),n("el-input",{attrs:{type:"file",accept:"image/*",disabled:t.loading,placeholder:t.n?t.n.replace(/C:\\fakepath\\/,""):"点击这里上传文件"},nativeOn:{change:function(e){return t.handleChange(e)}},model:{value:t.n,callback:function(e){t.n=e},expression:"n"}},[n("el-button",{attrs:{slot:"append",loading:t.loading},on:{click:t.start},slot:"append"},[t._v("\n                "+t._s(t.loading?t.loadingText:"开始获取")+"\n            ")])],1),n("div",{staticClass:"mt-15"},[n("span",[t._v("选择接口：")]),n("el-radio",{attrs:{label:"iqdb"},model:{value:t.apiType,callback:function(e){t.apiType=e},expression:"apiType"}},[t._v("\n                IQDB\n            ")]),n("el-radio",{attrs:{label:"saucenao"},model:{value:t.apiType,callback:function(e){t.apiType=e},expression:"apiType"}},[t._v("\n                SauceNAO\n            ")])],1),t.preview?n("div",{staticClass:"nya-subtitle"},[t._v("\n            预览\n        ")]):t._e(),t.preview?n("img",{staticClass:"preview",attrs:{src:t.preview,alt:"preview"}}):t._e()],1),t.data.length?n("nya-container",{attrs:{title:"获取成功"}},t._l(t.data,(function(e,o){return n("div",{key:o,staticClass:"imginfo"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.thumbnail,expression:"item.thumbnail"}]}),n("div",[t._v("\n                链接："),n("a",{attrs:{href:e.url,target:"_blank",rel:"noopener noreferrer"}},[t._v("\n                    "+t._s(e.url)+"\n                ")])]),e.title?n("div",[t._v("\n                标题："+t._s(e.title)+"\n            ")]):t._e()])})),0):t._e(),n("nya-container",{attrs:{title:"说明"}},[n("ul",{staticClass:"nya-list"},[n("li",[n("b",[t._v("暂时只支持 ACG 图片搜索")])]),n("li",[n("b",[t._v("请善于使用 "),n("nuxt-link",{attrs:{to:"/picture_clipping"}},[t._v("图片裁剪")]),t._v(" 更高效率的识别图片")],1)]),n("li",[t._v("识别成功率取决于上传的图片")]),n("li",[t._v("多个相同/类似结果是因为返回的数据包含多个相同/类似结果，推荐使用 Pixiv 的数据")])])])],1)}),[],!1,null,null,null);"function"==typeof d&&d(component);e.default=component.exports},643:function(t,e,n){"use strict";n(8);e.a=function(t){return new Promise((function(e,n){var o=new FileReader;o.readAsDataURL(t),o.onload=function(){return e(o.result)},o.onerror=function(t){return n(t)}}))}},737:function(t,e,n){"use strict";n(8);e.a={upload:function(t,e,n){var o=n.format,l=n.metaData;n.useCdn;return new Promise((function(n,r){var c=new FormData;c.append("image",e),t.$axios.post("/upload_image",c,{api_type:0,params:{format:o||"webp"}}).then((function(t){var e=new URL(t.data.data,"https://dogcloud-mikutools-cnapi.cdn.hatsune.tech/"),image=new Image;image.src=e,image.onload=function(){n(l?{url:e,e:t}:e)}})).catch(r)}))}}}}]);