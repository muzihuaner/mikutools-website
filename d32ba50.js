(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{1192:function(t,n,e){t.exports={}},2609:function(t,n,e){"use strict";e(1192)},2654:function(t,n,e){"use strict";e.r(n);e(253);var o=e(643),r=(e(8),{name:"WhatAnimeIsThis",data:function(){return{n:"",preview:"",file:null,docs:[],loading:!1}},methods:{handleChange:function(t){var n=this,e=t.target.files;if(!e.length)return!1;var r=e[0];this.docs=[],Object(o.a)(r).then((function(t){var image=new Image;image.src=t,image.onload=function(){var canvas=document.createElement("canvas"),t=canvas.getContext("2d");canvas.width=image.width,canvas.height=image.height,t.drawImage(image,0,0),n.preview=canvas.toDataURL(),function(t){return new Promise((function(n,e){fetch(t).then((function(t){return t.blob()})).then((function(t){var e=new File([t],"blob",{type:"image/jpeg"});n(e)})).catch(e)}))}(canvas.toDataURL()).then((function(t){n.file=t}))}}))},getAnime:function(){var t=this;if(!this.preview||!this.file)return!1;this.loading=!0;var n=new FormData;n.append("image",this.file),this.$axios.post("https://api.trace.moe/search?anilistInfo",n,{headers:{"Content-Type":"application/json"},auth:!1}).then((function(n){t.loading=!1,t.docs=n.data.result})).catch((function(n){t.$notify.error({title:"识别失败",message:n}),t.loading=!1}))},secToTime:function(s){var t;if(s>-1){var n=Math.floor(s/3600),e=Math.floor(s/60)%60,o=s%60;t=n<10?"0"+n+":":n+":",e<10&&(t+="0"),t+=e+":",o<10&&(t+="0"),t+=o.toFixed(2)}return t},toPercent:function(t){var n=Number(100*t).toFixed(2);return n+="%"},myCount:function(){var t=this;if(this.loading)return!1;this.loading=!0,this.$axios.get("https://api.trace.moe/me",{},{headers:{"Content-Type":"application/json"},auth:!1}).then((function(n){t.loading=!1;var e=n.data;t.$notify.info({title:"剩余次数",message:"本月总次数剩余：".concat(e.quota," 已使用：").concat(e.quotaUsed)})})).catch((function(n){t.loading=!1,t.$notify.error({title:"获取失败",message:n})}))}}}),l=(e(2609),e(2)),c=function(t){t.exports.head={meta:[{hid:"keywords",keywords:"根据截图搜索动漫,whatanime,MikuTools,Ice-Hazymoon,在线工具"},{hid:"description",description:"根据截图搜索动漫"}],title:"这是什么动漫 - MikuTools"},t.options.toolsMeta={name:"这是什么动漫",path:"/what_anime_is_this",head:{meta:[{hid:"keywords",keywords:"根据截图搜索动漫,whatanime,MikuTools,Ice-Hazymoon,在线工具"},{hid:"description",description:"根据截图搜索动漫"}],title:"这是什么动漫 - MikuTools"},show:!0,key:"other"}},component=Object(l.a)(r,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"what_anime_is_this"},[e("nya-container",{attrs:{title:"这是什么动漫"}},[e("div",{staticClass:"nya-subtitle mt-0"},[t._v("\n            请选择要识别动漫截图\n        ")]),e("el-input",{attrs:{type:"file",accept:"image/*",disabled:t.loading,placeholder:t.n?t.n.replace(/C:\\fakepath\\/,""):"点击这里上传文件"},nativeOn:{change:function(n){return t.handleChange(n)}},model:{value:t.n,callback:function(n){t.n=n},expression:"n"}},[e("el-button",{attrs:{slot:"append",loading:t.loading},on:{click:t.getAnime},slot:"append"},[t._v("\n                "+t._s(t.loading?"处理中":"开始处理")+"\n            ")])],1),t.preview?e("div",{staticClass:"nya-subtitle"},[t._v("\n            预览\n        ")]):t._e(),t.preview?e("img",{staticClass:"preview",attrs:{src:t.preview,alt:"preview"}}):t._e()],1),t.docs.length?e("nya-container",{staticClass:"typo",attrs:{title:"搜索结果"}},t._l(t.docs,(function(n,o){return e("table",{key:o},[e("tbody",[e("tr",[e("th",{attrs:{colspan:"2"}},[t._v("\n                        "+t._s(n.anilist.title.native+" "+(n.episode?"第"+n.episode+"集":""))+"\n                    ")])]),e("tr",[e("td",{attrs:{width:"100"}},[t._v("\n                        匹配位置\n                    ")]),e("td",[t._v(t._s(t.secToTime(n.from)))])]),e("tr",[e("td",{attrs:{width:"100"}},[t._v("\n                        相似度\n                    ")]),e("td",[t._v(t._s(t.toPercent(n.similarity)))])]),e("tr",[e("td",{attrs:{width:"100"}},[t._v("\n                        日文名称\n                    ")]),e("td",[t._v(t._s(n.anilist.title.native))])]),e("tr",[e("td",{attrs:{width:"100"}},[t._v("\n                        英文名称\n                    ")]),e("td",[t._v(t._s(n.anilist.title.english))])]),e("tr",[e("td",{staticClass:"video-td",attrs:{width:"400",colspan:"2"}},[e("video",{attrs:{controls:"",loop:"",poster:n.image,src:n.video}})])])])])})),0):t._e(),e("nya-container",{attrs:{title:"说明"}},[e("ul",{staticClass:"nya-list"},[e("li",[e("b",[t._v("请善于使用 "),e("nuxt-link",{attrs:{to:"/picture_clipping"}},[t._v("图片裁剪")]),t._v(" 更高效率的识别图片")],1)]),e("li",[t._v("\n                使用 trace.moe API，有使用次数限制。(\n                "),e("a",{on:{click:t.myCount}},[t._v("\n                    查看我的次数\n                ")]),t._v(")\n            ")]),e("li",[t._v("识别成功率取决于上传的截图")]),e("li",[t._v("多个相同/类似结果是因为返回的数据包含多个相同/类似结果")])])])],1)}),[],!1,null,null,null);"function"==typeof c&&c(component);n.default=component.exports},643:function(t,n,e){"use strict";e(8);n.a=function(t){return new Promise((function(n,e){var o=new FileReader;o.readAsDataURL(t),o.onload=function(){return n(o.result)},o.onerror=function(t){return e(t)}}))}}}]);